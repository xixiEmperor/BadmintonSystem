import{u as M,r as u,o as $,L as V,q as C,l,j as s,w as n,s as j,ac as H,an as K,n as k,ar as Q,a0 as A,i as v,F as w,P as G,Q as J,f as E,aq as O,as as W,p as X,v as Y,aH as Z,B as m,E as ee}from"./index-CHTw6ThQ.js";/* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                    *//* empty css                  */import{n as g}from"./router-opkYfn4s.js";import{g as te}from"./forum-BJTiRufs.js";import{u as ae}from"./forum-r9D-h3UH.js";import{f as S}from"./format-BoKD-3ja.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const le={class:"forum-container"},se={class:"forum-actions"},ne={class:"forum-content"},ie={class:"topics-container"},re=["onClick"],ue={class:"topic-author"},pe={class:"topic-stats"},me={class:"topic-last-reply"},ce={class:"pagination-container"},de={__name:"ForumView",setup(_e){const z=M(),T=ae(),D=u([{name:"all",label:"全部帖子"},{name:"team",label:"打球组队"},{name:"notice",label:"赛事讨论"},{name:"help",label:"求助问答"},{name:"exp",label:"经验交流"}]),c=u("all"),d=u("");let f=null;const r=u(1),h=u(5),b=u(0),p=async()=>{const a=await te({page:r.value,pageSize:h.value,keyword:d.value,category:c.value});if(a.data.code===0){console.log(a);const t=a.data.data.list.map(o=>({...o,publishTime:S(o.publishTime),lastReply:S(o.lastReply)}));t.sort((o,i)=>o.isTop&&!i.isTop?-1:!o.isTop&&i.isTop?1:o.isTop&&i.isTop?new Date(i.topTime||i.publishTime)-new Date(o.topTime||o.publishTime):new Date(i.publishTime)-new Date(o.publishTime)),T.setPosts(t),b.value=a.data.data.total}};$(async()=>{await p()});const x=()=>{if(!z.token){ee.warning("请先登录后再发布文章"),g("/login");return}g("/publish-post")},F=a=>{g(`/post/${a}`)},y=()=>{f&&clearTimeout(f),f=setTimeout(()=>{r.value=1,p()},500)},P=a=>{r.value=a,p()},B=a=>{h.value=a,r.value=1,p()};V(c,()=>{r.value=1,p()}),V(d,()=>{y()});const L=({row:a})=>a.isTop?"top-row":"";return(a,t)=>{const o=j,i=H,N=O,R=K,U=Y,_=W,I=Q,q=A;return v(),C("div",le,[t[5]||(t[5]=l("h2",null,"羽你同行论坛",-1)),l("div",se,[s(o,{type:"primary",onClick:x},{default:n(()=>t[3]||(t[3]=[w("发布新帖")])),_:1}),s(i,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),placeholder:"搜索论坛内容",class:"search-input"},{append:n(()=>[s(o,{onClick:y},{default:n(()=>t[4]||(t[4]=[w("搜索")])),_:1})]),_:1},8,["modelValue"])]),l("div",ne,[s(R,{modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=e=>c.value=e),class:"demo-tabs"},{default:n(()=>[(v(!0),C(G,null,J(D.value,e=>(v(),E(N,{key:e.name,label:e.label,name:e.name},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),l("div",ie,[s(I,{data:k(T).posts,style:{width:"100%"},"row-class-name":L},{default:n(()=>[s(_,{prop:"title",label:"主题","min-width":"300"},{default:n(e=>[l("div",{class:"topic-title",onClick:ve=>F(e.row.id)},[e.row.isTop?(v(),E(U,{key:0,class:"top-icon"},{default:n(()=>[s(k(Z))]),_:1})):X("",!0),w(" "+m(e.row.title),1)],8,re)]),_:1}),s(_,{prop:"author",label:"作者",width:"120"},{default:n(e=>[l("div",ue,m(e.row.author),1)]),_:1}),s(_,{prop:"replies",label:"回复/查看",width:"120"},{default:n(e=>[l("div",pe,[l("div",null,m(e.row.replyCount||0)+" 回复",1),l("div",null,m(e.row.views)+" 查看",1)])]),_:1}),s(_,{prop:"lastReply",label:"最后回复",width:"120"},{default:n(e=>[l("div",me,m(e.row.lastReply),1)]),_:1})]),_:1},8,["data"])]),l("div",ce,[s(q,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=e=>r.value=e),"page-size":h.value,total:b.value,"page-sizes":[5,8,10,15],layout:"total, sizes, prev, pager, next",onSizeChange:B,onCurrentChange:P},null,8,["modelValue","page-size","total"])])])])}}},Pe=oe(de,[["__scopeId","data-v-19021ca8"]]);export{Pe as default};
