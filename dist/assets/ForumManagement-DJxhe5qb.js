import{r as s,o as K,q as C,l as r,j as o,w as l,U as Q,E as u,b as R,i as d,M as A,an as G,P as H,Q as J,f as h,aq as O,ar as W,as as X,p as Y,a1 as Z,F as i,b5 as ee,B as b,s as te,_ as ae,a0 as oe,ac as le,c as ne}from"./index-CZU4bJ5v.js";/* empty css                   *//* empty css                *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                *//* empty css                    *//* empty css                  */import{g as se,s as re,h as ie}from"./forum-Dsj9shzh.js";/* empty css                       *//* empty css                   */import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"forum-management"},de={class:"card-header"},me={class:"search-box"},pe={class:"category-tabs"},_e={class:"title-cell"},ge={class:"action-buttons"},ve={class:"pagination-container"},fe={__name:"ForumManagement",setup(he){const k=R(),E=s([{name:"all",label:"全部帖子"},{name:"team",label:"打球组队"},{name:"notice",label:"赛事讨论"},{name:"help",label:"求助问答"},{name:"exp",label:"经验交流"}]),m=s("all"),w=s([]),y=s(0),p=s(1),g=s(10),_=s(!1),v=s(""),x=()=>{p.value=1,n()},n=async()=>{_.value=!0;try{const t={page:p.value,size:g.value,keyword:v.value,category:m.value!=="all"?m.value:void 0},e=await se(t);w.value=e.data.data.list||[],y.value=e.data.data.total||0,_.value=!1}catch(t){console.error("获取帖子列表失败:",t),u.error("获取帖子列表失败"),_.value=!1}},z=t=>{ne.confirm(`确定要删除标题为「${t.title}」的帖子吗？`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await ie(t.id),u.success("删除成功"),n()}catch(e){console.error("删除帖子失败:",e),u.error("删除帖子失败")}}).catch(()=>{})},V=t=>{g.value=t,n()},B=t=>{p.value=t,n()},P=async t=>{try{console.log(t);const e=!t.isTop;await re(t.id,e),u.success(e?"帖子已设为置顶":"帖子已取消置顶"),n()}catch(e){console.error("设置置顶状态失败:",e),u.error("设置置顶状态失败")}},S=t=>{k.push(`/admin/forum/post/${t.id}`)},L=t=>t?new Date(t).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-";return K(()=>{n()}),(t,e)=>{const f=te,D=le,F=O,M=G,N=Z,$=ee,c=X,U=W,j=oe,q=Q,I=ae;return d(),C("div",ue,[e[6]||(e[6]=r("h2",null,"论坛管理",-1)),o(q,{class:"forum-card"},{header:l(()=>[r("div",de,[e[3]||(e[3]=r("span",null,"帖子列表",-1)),r("div",me,[o(D,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=a=>v.value=a),placeholder:"搜索帖子内容",clearable:"",onClear:n},{append:l(()=>[o(f,{onClick:n},{default:l(()=>e[2]||(e[2]=[i("搜索")])),_:1})]),_:1},8,["modelValue"])])])]),default:l(()=>[r("div",pe,[o(M,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=a=>m.value=a),onTabClick:x},{default:l(()=>[(d(!0),C(H,null,J(E.value,a=>(d(),h(F,{key:a.name,label:a.label,name:a.name},null,8,["label","name"]))),128))]),_:1},8,["modelValue"])]),A((d(),h(U,{data:w.value,style:{width:"100%"}},{default:l(()=>[o(c,{prop:"title",label:"标题","min-width":"180","show-overflow-tooltip":""},{default:l(a=>[r("div",_e,[a.row.isTop?(d(),h(N,{key:0,type:"danger",effect:"dark",size:"small",class:"top-tag"},{default:l(()=>e[4]||(e[4]=[i("置顶")])),_:1})):Y("",!0),o($,{type:"primary",onClick:T=>S(a.row),underline:!1},{default:l(()=>[i(b(a.row.title),1)]),_:2},1032,["onClick"])])]),_:1}),o(c,{prop:"category",label:"文章类别","min-width":"120"}),o(c,{prop:"author",label:"作者",width:"120"}),o(c,{prop:"publishTime",label:"创建时间",width:"180"},{default:l(a=>[i(b(L(a.row.publishTime)),1)]),_:1}),o(c,{label:"操作",width:"180",fixed:"right"},{default:l(a=>[r("div",ge,[o(f,{type:a.row.isTop?"warning":"success",size:"small",onClick:T=>P(a.row)},{default:l(()=>[i(b(a.row.isTop?"取消置顶":"置顶"),1)]),_:2},1032,["type","onClick"]),o(f,{type:"danger",size:"small",onClick:T=>z(a.row)},{default:l(()=>e[5]||(e[5]=[i("删除")])),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[I,_.value]]),r("div",ve,[o(j,{background:"",layout:"total, sizes, prev, pager, next, jumper",total:y.value,"page-size":g.value,"current-page":p.value,"page-sizes":[10,20,50,100],onSizeChange:V,onCurrentChange:B},null,8,["total","page-size","current-page"])])]),_:1})])}}},$e=ce(fe,[["__scopeId","data-v-8388adf8"]]);export{$e as default};
