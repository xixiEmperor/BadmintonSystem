import{al as F,r as g,o as S,q as u,l as t,M as N,f as d,p as v,j as k,w as r,s as P,_ as b,E as l,U as H,b as V,i as a,F as m,B as n,a1 as z,P as I,Q as R,c as j}from"./index-CZU4bJ5v.js";/* empty css                   *//* empty css                *//* empty css               *//* empty css                  */import{a as q,b as Q,f as U,s as $}from"./forum-Dsj9shzh.js";/* empty css                       *//* empty css                 *//* empty css                   */import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"post-detail"},J={class:"header-actions"},K={key:0},O={class:"post-header"},W={class:"post-title"},X={class:"post-meta"},Y={class:"post-content"},Z=["innerHTML"],tt={class:"post-stats"},et={key:1,class:"not-found"},st={class:"comments-header"},ot={class:"comments-list"},at={class:"comment-header"},nt={class:"author"},rt={class:"time"},lt={class:"comment-content"},ct=["innerHTML"],it={class:"comment-actions"},ut={__name:"ForumPostDetail",setup(dt){const C=F(),w=V(),p=C.params.id,c=g(!0),s=g(null),_=g([]),B=async()=>{c.value=!0;try{const e=await q(p);s.value=e.data.data,c.value=!1,s.value&&y()}catch(e){console.error("获取帖子详情失败:",e),l.error("获取帖子详情失败"),c.value=!1}},D=async()=>{try{const e=!s.value.isTop;await $(p,e),l.success(e?"帖子已设为置顶":"帖子已取消置顶"),s.value.isTop=e}catch(e){console.error("设置置顶状态失败:",e),l.error("设置置顶状态失败")}},y=async()=>{try{const e=await Q(p,"time");_.value=e.data.data||[]}catch(e){console.error("获取回复列表失败:",e),l.error("获取回复列表失败")}},x=e=>{j.confirm("确定要删除这条评论吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await U(p,e.id),l.success("评论删除成功"),y()}catch(o){console.error("删除评论失败:",o),l.error("删除评论失败")}}).catch(()=>{})},M=()=>{w.go(-1)},T=e=>e?new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-";return S(()=>{B()}),(e,o)=>{const h=P,E=z,f=H,L=b;return a(),u("div",G,[t("div",J,[k(h,{type:"primary",onClick:M},{default:r(()=>o[0]||(o[0]=[m("返回")])),_:1}),s.value?(a(),d(h,{key:0,type:s.value.isTop?"warning":"success",onClick:D},{default:r(()=>[m(n(s.value.isTop?"取消置顶":"设为置顶"),1)]),_:1},8,["type"])):v("",!0)]),N((a(),d(f,null,{default:r(()=>[s.value?(a(),u("div",K,[t("div",O,[t("h2",W,[s.value.isTop?(a(),d(E,{key:0,type:"danger",effect:"dark",size:"small",class:"top-tag"},{default:r(()=>o[1]||(o[1]=[m("置顶")])),_:1})):v("",!0),m(" "+n(s.value.title),1)]),t("div",X,[t("span",null,"作者: "+n(s.value.author),1),t("span",null,"发布时间: "+n(T(s.value.publishTime)),1),t("span",null,"类别: "+n(s.value.category),1)])]),t("div",Y,[t("p",{innerHTML:s.value.content},null,8,Z)]),t("div",tt,[t("span",null,"点赞数: "+n(s.value.likeCount),1),t("span",null,"回复数: "+n(s.value.replyCount),1)])])):c.value?v("",!0):(a(),u("div",et,o[2]||(o[2]=[t("p",null,"帖子不存在或已被删除",-1)])))]),_:1})),[[L,c.value]]),s.value&&_.value.length>0?(a(),d(f,{key:0,class:"comments-card"},{header:r(()=>[t("div",st,[t("span",null,"回复列表 ("+n(_.value.length)+")",1)])]),default:r(()=>[t("div",ot,[(a(!0),u(I,null,R(_.value,i=>(a(),u("div",{key:i.id,class:"comment-item"},[t("div",at,[t("span",nt,n(i.author),1),t("span",rt,n(T(i.createTime)),1)]),t("div",lt,[t("p",{innerHTML:i.content},null,8,ct)]),t("div",it,[k(h,{type:"danger",size:"small",onClick:mt=>x(i)},{default:r(()=>o[3]||(o[3]=[m(" 删除评论 ")])),_:2},1032,["onClick"])])]))),128))])]),_:1})):s.value?(a(),d(f,{key:1,class:"comments-card"},{default:r(()=>o[4]||(o[4]=[t("div",{class:"no-comments"}," 暂无回复 ",-1)])),_:1})):v("",!0)])}}},wt=A(ut,[["__scopeId","data-v-69dd9c96"]]);export{wt as default};
