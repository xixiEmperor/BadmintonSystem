import{r as F,o as M,q as C,l as n,j as s,w as i,H as Q,F as k,P as N,Q as z,G as Y,O as V,a1 as Z,i as u,f as I,B as w,K as L,d as X,L as ee,M as oe,p as B,ab as te,Z as ae,Y as se,ac as ne,R as re,s as j,ae as le,_ as ce,ah as ie,$ as de,a0 as ue,E as D,b as R,ai as pe,U as _e,a3 as me,aj as ge,a4 as ye,a7 as he,a as ve,g as fe,ak as Ce,I as $e}from"./index-CZU4bJ5v.js";/* empty css                *//* empty css               *//* empty css                     */import"./el-tooltip-l0sNRNKZ.js";/* empty css                     */import{g as be,a as Ee,b as we}from"./shop-Bqh9CrLv.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                   *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                 *//* empty css               *//* empty css                *//* empty css                     *//* empty css                  *//* empty css                         */const Fe={class:"category-list"},ke={class:"mobile-categories"},Se={class:"category-tags"},Ie={__name:"CategoryList",emits:["category-selected"],setup(x,{emit:$}){const p=F([]),y=F("all"),E=async()=>{const h=await be();p.value=h.data.data},r=h=>{y.value=h,m("category-selected",h)},m=$;return M(()=>{E()}),(h,c)=>{const v=Q,o=Y,t=Z;return u(),C("div",Fe,[c[3]||(c[3]=n("h2",null,"商品分类",-1)),s(o,{class:"category-menu desktop-menu","default-active":y.value,onSelect:r},{default:i(()=>[s(v,{index:"all"},{default:i(()=>c[1]||(c[1]=[k(" 全部商品 ")])),_:1}),(u(!0),C(N,null,z(p.value,a=>(u(),I(v,{key:a.id,index:a.id.toString()},{default:i(()=>[k(w(a.name),1)]),_:2},1032,["index"]))),128))]),_:1},8,["default-active"]),n("div",ke,[n("div",Se,[s(t,{class:V(["category-tag",{active:y.value==="all"}]),onClick:c[0]||(c[0]=a=>r("all")),effect:"plain"},{default:i(()=>c[2]||(c[2]=[k(" 全部商品 ")])),_:1},8,["class"]),(u(!0),C(N,null,z(p.value,a=>(u(),I(t,{key:a.id,class:V(["category-tag",{active:y.value===a.id.toString()}]),onClick:d=>r(a.id.toString()),effect:"plain"},{default:i(()=>[k(w(a.name),1)]),_:2},1032,["class","onClick"]))),128))])])])}}},T=A(Ie,[["__scopeId","data-v-030a4f76"]]),xe={class:"product-list"},Ne={class:"filter-panel"},ze={class:"filter-row"},Be={class:"button-row"},Ae={class:"product-grid"},De=["src"],Me={class:"product-info"},Pe={class:"product-name"},Ve={class:"product-subtitle"},Le={class:"product-price-row"},Te={class:"product-price"},Ue={class:"product-sales"},je={key:0,class:"pagination-container"},Re={__name:"ProductList",props:{categoryId:{type:[String,Number],default:"all"}},setup(x){const $=x,p=R(),y=F(!1),E=F([]),r=L({keyword:"",orderBy:"",pageNum:1,pageSize:8,categoryId:$.categoryId}),m=L({pageNum:1,pageSize:8,total:0}),h=X(()=>window.innerWidth<=768?"prev, pager, next":"total, sizes, prev, pager, next, jumper"),c=async()=>{y.value=!0;try{const e=await Ee(r);e.data.code===0?(E.value=e.data.data.list,m.pageNum=e.data.data.pageNum,m.pageSize=e.data.data.pageSize,m.total=e.data.data.total):D.error("获取商品列表失败")}catch(e){console.error("获取商品列表失败:",e),D.error("获取商品列表失败")}finally{y.value=!1}};ee(()=>$.categoryId,e=>{r.categoryId=e,r.pageNum=1,c()},{immediate:!0});const v=()=>{r.pageNum=1,c()},o=()=>{r.keyword="",r.orderBy="",r.pageNum=1,c()},t=e=>{r.pageSize=e,c()},a=e=>{r.pageNum=e,c()},d=e=>{p.push(`/product/${e}`)};return(e,l)=>{const _=se,b=ae,g=te,S=ne,P=j,K=le,O=_e,W=pe,q=ie,G=de,H=ue,J=ce;return u(),C("div",xe,[n("div",Ne,[s(K,{inline:!0,class:"filter-form"},{default:i(()=>[n("div",ze,[s(g,{label:"排序方式",class:"sort-item"},{default:i(()=>[s(b,{modelValue:r.orderBy,"onUpdate:modelValue":l[0]||(l[0]=f=>r.orderBy=f),placeholder:"请选择"},{default:i(()=>[s(_,{label:"默认排序",value:""}),s(_,{label:"价格升序",value:"price_asc"}),s(_,{label:"价格降序",value:"price_desc"}),s(_,{label:"销量降序",value:"sales_desc"})]),_:1},8,["modelValue"])]),_:1}),s(g,{label:"关键词",class:"search-item"},{default:i(()=>[s(S,{modelValue:r.keyword,"onUpdate:modelValue":l[1]||(l[1]=f=>r.keyword=f),placeholder:"请输入关键词",onKeyup:re(v,["enter"])},null,8,["modelValue"])]),_:1})]),n("div",Be,[s(g,null,{default:i(()=>[s(P,{type:"primary",onClick:v},{default:i(()=>l[2]||(l[2]=[k("搜索")])),_:1}),s(P,{onClick:o},{default:i(()=>l[3]||(l[3]=[k("重置")])),_:1})]),_:1})])]),_:1})]),oe((u(),C("div",Ae,[s(q,{gutter:20},{default:i(()=>[(u(!0),C(N,null,z(E.value,f=>(u(),I(W,{xs:12,sm:12,md:8,lg:6,key:f.id},{default:i(()=>[s(O,{class:"product-card",onClick:ao=>d(f.id)},{default:i(()=>[n("img",{src:f.mainImage,class:"product-image"},null,8,De),n("div",Me,[n("h3",Pe,w(f.name),1),n("p",Ve,w(f.subtitle),1),n("div",Le,[n("span",Te,"¥"+w(f.price.toFixed(2)),1),n("span",Ue,"销量: "+w(f.sales),1)])])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),E.value.length===0&&!y.value?(u(),I(G,{key:0,description:"暂无商品"})):B("",!0)])),[[J,y.value]]),m.total>0?(u(),C("div",je,[s(H,{background:"",onSizeChange:t,onCurrentChange:a,"current-page":m.pageNum,"page-sizes":[8,4,6,10,12],"page-size":m.pageSize,layout:h.value,total:m.total},null,8,["current-page","page-size","layout","total"])])):B("",!0)])}}},U=A(Re,[["__scopeId","data-v-e932d64b"]]),Ke={class:"product-carousel"},Oe={class:"content-left"},We={class:"carousel-title"},qe={class:"carousel-subtitle"},Ge={class:"content-right"},He=["src","alt"],Je={__name:"ProductCarousel",setup(x){const $=R(),p=F([]),y=o=>{$.push(`/product/${o}`)},E=async()=>{try{const o=await we();o.data.code===0?p.value=o.data.data:D.error(o.data.msg)}catch(o){console.error("获取轮播图数据失败",o)}};F([]);const r=[{primary:"#FF6B6B",secondary:"#4ECDC4"},{primary:"#845EC2",secondary:"#FF8066"},{primary:"#FFD93D",secondary:"#6BCF7F"},{primary:"#FF8E9B",secondary:"#C7CEEA"},{primary:"#A8E6CF",secondary:"#FFEAA7"},{primary:"#74B9FF",secondary:"#FD79A8"},{primary:"#FDCB6E",secondary:"#6C5CE7"},{primary:"#55A3FF",secondary:"#FEA47F"},{primary:"#26DE81",secondary:"#FC7C7C"},{primary:"#A29BFE",secondary:"#FDA085"}],m=o=>{let t=0;for(let a=0;a<o.length;a++){const d=o.charCodeAt(a);t=(t<<5)-t+d,t=t&t}return Math.abs(t)%r.length},h=async()=>{console.log("🎨 开始设置主题色，使用预设颜色方案"),console.log("轮播图数据:",p.value);try{p.value.forEach((o,t)=>{const a=m(o.productName+o.productId),d=r[a],e=`linear-gradient(135deg, ${d.primary}CC, ${d.secondary}AA)`;o.bgColor=e,console.log(`🎨 商品"${o.productName}"应用颜色方案${a+1}: ${d.primary} → ${d.secondary}`),console.log(`   渐变效果: ${e}`)}),console.log("🎉 所有主题色设置完成")}catch(o){console.error("❌ 设置主题色失败:",o)}},c=async()=>{console.log("🌐 通过后端代理获取主题色"),console.log("图片列表:",p.value.map(o=>({name:o.productName,url:o.mainImage})));try{const o=p.value.map(async(e,l)=>{try{console.log(`📡 开始请求图片${l+1}: ${e.productName}`),console.log(`   图片URL: ${e.mainImage}`);const _=await ge.post("/api/image/extract-color",{imageUrl:e.mainImage});if(console.log(`📡 图片${l+1}响应:`,_.data),_.data.code===0){const b=_.data.data.color,g=_.data.data.source,S=`linear-gradient(135deg, ${b}CC, ${v(b,-30)}DD)`;return e.bgColor=S,e.colorSource=g==="oss"?"阿里云OSS":g==="java"?"Java处理":g,console.log(`✅ 通过${g}获取到图片${l+1}的主题色: ${b}`),console.log(`   渐变效果: ${S}`),{color:b,source:g,success:!0}}else throw new Error(_.data.msg||"后端返回错误")}catch(_){console.error(`❌ 图片${l+1}(${e.productName})颜色获取失败:`,_.message);const b=m(e.productName+e.productId),g=r[b],S=`linear-gradient(135deg, ${g.primary}CC, ${g.secondary}AA)`;return e.bgColor=S,e.colorSource="预设方案",console.log(`🔄 图片${l+1}回退到预设颜色方案${b+1}: ${g.primary} → ${g.secondary}`),{color:g.primary,source:"fallback",success:!1,error:_.message}}}),t=await Promise.all(o),a=t.filter(e=>e.success).length,d=t.filter(e=>!e.success).length;console.log("🎉 代理方式主题色获取完成!"),console.log(`   成功: ${a}/${t.length}`),console.log(`   回退: ${d}/${t.length}`),console.log("   详细结果:",t),a===0&&console.warn("⚠️ 所有图片都获取颜色失败，可能需要检查后端服务")}catch(o){console.error("❌ 代理方式获取主题色完全失败:",o),console.log("🔄 完全回退到预设方案"),await h()}},v=(o,t)=>{const a=o.replace("#",""),d=parseInt(a,16),e=Math.max(0,Math.min(255,(d>>16)+t)),l=Math.max(0,Math.min(255,(d>>8&255)+t)),_=Math.max(0,Math.min(255,(d&255)+t));return"#"+((1<<24)+(e<<16)+(l<<8)+_).toString(16).slice(1)};return M(async()=>{await E(),console.log("📦 轮播图数据加载完成，开始获取真实图片颜色"),await c()}),(o,t)=>{const a=j,d=ye,e=me;return u(),C("div",Ke,[s(e,{interval:4e3,type:"card",height:"280px","indicator-position":"outside",arrow:"never",class:"carousel-container"},{default:i(()=>[(u(!0),C(N,null,z(p.value,l=>(u(),I(d,{key:l.productId,class:"carousel-item"},{default:i(()=>[n("div",{class:"carousel-content",style:he({background:l.bgColor||"linear-gradient(135deg, #6366f1AA, #4f46e5DD)"})},[n("div",Oe,[n("h3",We,w(l.productName),1),n("p",qe,w(l.subtitle),1),s(a,{type:"primary",size:"large",class:"carousel-button",onClick:_=>y(l.productId)},{default:i(()=>t[0]||(t[0]=[k(" 立即购买 ")])),_:2},1032,["onClick"])]),n("div",Ge,[n("img",{src:l.mainImage,alt:l.productName,class:"carousel-image"},null,8,He)])],4)]),_:2},1024))),128))]),_:1})])}}},Qe=A(Je,[["__scopeId","data-v-805635c4"]]),Ye={class:"shop-container"},Ze={class:"category-section"},Xe={key:1,class:"mobile-layout"},eo={class:"mobile-category"},oo={class:"mobile-products"},to={__name:"ShopView",setup(x){const $=F("all"),p=F(!1),y=()=>{p.value=window.innerWidth<=768},r=((h,c)=>{let v;return function(...t){const a=()=>{clearTimeout(v),h(...t)};clearTimeout(v),v=setTimeout(a,c)}})(y,150),m=h=>{$.value=h};return M(()=>{y(),window.addEventListener("resize",r)}),ve(()=>{window.removeEventListener("resize",r)}),(h,c)=>{const v=Ce,o=$e,t=fe;return u(),C("div",Ye,[c[0]||(c[0]=n("div",{class:"page-header"},[n("h1",{class:"page-title"},"羽体商城"),n("p",{class:"page-subtitle"},"专业羽毛球装备，助力你的运动表现")],-1)),s(Qe),p.value?B("",!0):(u(),I(t,{key:0,class:"desktop-layout"},{default:i(()=>[s(v,{width:"240px",class:"sidebar"},{default:i(()=>[n("div",Ze,[s(T,{onCategorySelected:m})])]),_:1}),s(o,{class:"main-content"},{default:i(()=>[s(U,{categoryId:$.value},null,8,["categoryId"])]),_:1})]),_:1})),p.value?(u(),C("div",Xe,[n("div",eo,[s(T,{onCategorySelected:m})]),n("div",oo,[s(U,{categoryId:$.value},null,8,["categoryId"])])])):B("",!0)])}}},Eo=A(to,[["__scopeId","data-v-973c1984"]]);export{Eo as default};
