import{r as c,K as C,o as W,q as X,l as g,j as t,w as l,ae as ee,M as te,_ as oe,f as U,a0 as ae,a2 as le,E as n,ar as ne,i as k,ab as se,ac as re,Z as ie,Y as de,s as ue,F as r,as as pe,a1 as ce,B as T,n as me,p as fe,c as $}from"./index-CZU4bJ5v.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                     *//* empty css                  */import{b as ge,c as ye,p as I,d as _e,u as ve}from"./booking-DJVTAb69.js";import{f as be}from"./format-BoKD-3ja.js";/* empty css                       */import{_ as we}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ve={class:"notice-publish"},Ce={class:"form-container"},ke={class:"notice-list"},Te={class:"pagination-container"},xe={class:"dialog-footer"},Ee={name:"NoticePublishPage"},Ne=Object.assign(Ee,{setup(Fe){const b=c(null),i=C({title:"",content:"",type:1}),x=C({title:[{required:!0,message:"请输入通知标题",trigger:"blur"}],content:[{required:!0,message:"请输入通知内容",trigger:"blur"}]}),w=c(!1),_=c(1),V=c(5),E=c(0),N=c([]),y=c(!1),F=c(null),s=C({id:"",title:"",content:"",type:1}),P=o=>({1:"",2:"warning"})[o]||"",L=o=>({1:"普通通知",2:"重要通知"})[o]||"未知",R=o=>({0:"info",1:"success"})[o]||"",j=o=>({0:"草稿",1:"已发布"})[o]||"未知",m=async()=>{try{w.value=!0;const o=await ge({pageNum:_.value,pageSize:V.value});o.data.code===0?(N.value=o.data.data.list,E.value=o.data.data.total):n.error(o.data.msg||"获取通知列表失败")}catch(o){console.error("获取通知列表失败:",o),n.error("获取通知列表失败")}finally{w.value=!1}},M=async o=>{if(await b.value.validate().catch(()=>!1))try{const d=await ye({title:i.title,content:i.content,type:i.type});if(d.data.code===0){if(o===1){const u=d.data.data;await I(u),n.success("通知发布成功")}else n.success("通知保存成功");z(),m()}else n.error(d.data.msg||"操作失败")}catch(d){console.error("提交通知失败:",d),n.error("操作失败")}},z=()=>{b.value.resetFields()},q=o=>{s.id=o.id,s.title=o.title,s.content=o.content,s.type=o.type,y.value=!0},O=async o=>{try{await $.confirm("确认发布该通知吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=await I(o.id);e.data.code===0?(n.success("通知发布成功"),m()):n.error(e.data.msg||"发布失败")}catch(e){e!=="cancel"?(console.error("发布通知失败:",e),n.error("发布失败")):n.info("已取消发布操作")}},A=async()=>{if(await F.value.validate().catch(()=>!1))try{const e=await ve(s.id,{title:s.title,content:s.content,type:s.type});e.data.code===0?(n.success("通知更新成功"),y.value=!1,m()):n.error(e.data.msg||"更新失败")}catch(e){console.error("更新通知失败:",e),n.error("更新失败")}},H=async o=>{try{await $.confirm("确认删除该通知吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=await _e(o.id);e.data.code===0?(n.success("通知已删除"),m()):n.error(e.data.msg||"删除失败")}catch(e){e!=="cancel"?(console.error("删除通知失败:",e),n.error("删除失败")):n.info("已取消删除操作")}},K=o=>{V.value=o,_.value=1,m()},Y=o=>{_.value=o,m()};return W(()=>{m()}),(o,e)=>{const d=re,u=se,v=de,B=ie,p=ue,h=ee,f=pe,S=ce,Z=ne,G=ae,J=le,Q=oe;return k(),X("div",Ve,[e[19]||(e[19]=g("h2",{class:"page-title"},"发布通知",-1)),g("div",Ce,[t(h,{model:i,rules:x,ref_key:"noticeFormRef",ref:b,"label-width":"80px"},{default:l(()=>[t(u,{label:"标题",prop:"title"},{default:l(()=>[t(d,{modelValue:i.title,"onUpdate:modelValue":e[0]||(e[0]=a=>i.title=a),placeholder:"请输入通知标题"},null,8,["modelValue"])]),_:1}),t(u,{label:"内容",prop:"content"},{default:l(()=>[t(d,{modelValue:i.content,"onUpdate:modelValue":e[1]||(e[1]=a=>i.content=a),type:"textarea",rows:8,placeholder:"请输入通知内容"},null,8,["modelValue"])]),_:1}),t(u,{label:"类型"},{default:l(()=>[t(B,{modelValue:i.type,"onUpdate:modelValue":e[2]||(e[2]=a=>i.type=a),placeholder:"请选择通知类型"},{default:l(()=>[t(v,{label:"普通通知",value:1}),t(v,{label:"重要通知",value:2})]),_:1},8,["modelValue"])]),_:1}),t(u,null,{default:l(()=>[t(p,{type:"primary",onClick:e[3]||(e[3]=a=>M(1))},{default:l(()=>e[10]||(e[10]=[r("发布通知")])),_:1}),t(p,{type:"info",onClick:e[4]||(e[4]=a=>M(0))},{default:l(()=>e[11]||(e[11]=[r("保存草稿")])),_:1}),t(p,{onClick:z},{default:l(()=>e[12]||(e[12]=[r("重置")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),g("div",ke,[e[16]||(e[16]=g("h3",{class:"section-title"},"已发布通知",-1)),te((k(),U(Z,{data:N.value,border:"",style:{width:"100%"}},{default:l(()=>[t(f,{prop:"id",label:"ID",width:"80"}),t(f,{prop:"title",label:"标题",width:"200"}),t(f,{prop:"content",label:"内容","show-overflow-tooltip":""}),t(f,{prop:"type",label:"类型",width:"100"},{default:l(a=>[t(S,{type:P(a.row.type)},{default:l(()=>[r(T(L(a.row.type)),1)]),_:2},1032,["type"])]),_:1}),t(f,{prop:"status",label:"状态",width:"100"},{default:l(a=>[t(S,{type:R(a.row.status)},{default:l(()=>[r(T(j(a.row.status)),1)]),_:2},1032,["type"])]),_:1}),t(f,{prop:"createTime",label:"发布时间",width:"180"},{default:l(a=>[r(T(me(be)(a.row.publishTime||a.row.createTime)),1)]),_:1}),t(f,{label:"操作",width:"200"},{default:l(a=>[t(p,{size:"small",type:"primary",onClick:D=>q(a.row)},{default:l(()=>e[13]||(e[13]=[r("编辑")])),_:2},1032,["onClick"]),a.row.status===0?(k(),U(p,{key:0,size:"small",type:"success",onClick:D=>O(a.row)},{default:l(()=>e[14]||(e[14]=[r(" 发布 ")])),_:2},1032,["onClick"])):fe("",!0),t(p,{size:"small",type:"danger",onClick:D=>H(a.row)},{default:l(()=>e[15]||(e[15]=[r("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Q,w.value]]),g("div",Te,[t(G,{background:"",layout:"total, sizes, prev, pager, next, jumper",total:E.value,"page-size":V.value,"page-sizes":[5,8,10,15],"current-page":_.value,onSizeChange:K,onCurrentChange:Y},null,8,["total","page-size","current-page"])])]),t(J,{modelValue:y.value,"onUpdate:modelValue":e[9]||(e[9]=a=>y.value=a),title:"编辑通知",width:"50%"},{footer:l(()=>[g("span",xe,[t(p,{onClick:e[8]||(e[8]=a=>y.value=!1)},{default:l(()=>e[17]||(e[17]=[r("取消")])),_:1}),t(p,{type:"primary",onClick:A},{default:l(()=>e[18]||(e[18]=[r("确认")])),_:1})])]),default:l(()=>[t(h,{model:s,rules:x,ref_key:"editFormRef",ref:F,"label-width":"80px"},{default:l(()=>[t(u,{label:"标题",prop:"title"},{default:l(()=>[t(d,{modelValue:s.title,"onUpdate:modelValue":e[5]||(e[5]=a=>s.title=a),placeholder:"请输入通知标题"},null,8,["modelValue"])]),_:1}),t(u,{label:"内容",prop:"content"},{default:l(()=>[t(d,{modelValue:s.content,"onUpdate:modelValue":e[6]||(e[6]=a=>s.content=a),type:"textarea",rows:8,placeholder:"请输入通知内容"},null,8,["modelValue"])]),_:1}),t(u,{label:"类型"},{default:l(()=>[t(B,{modelValue:s.type,"onUpdate:modelValue":e[7]||(e[7]=a=>s.type=a),placeholder:"请选择通知类型"},{default:l(()=>[t(v,{label:"普通通知",value:1}),t(v,{label:"重要通知",value:2})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),Ye=we(Ne,[["__scopeId","data-v-c9aa88ca"]]);export{Ye as default};
