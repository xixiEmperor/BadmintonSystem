import{r as y,o as x,al as V,E as z,b as B,q as d,l as t,j as e,w as a,v as I,p as S,B as c,s as P,ag as R,i as r,n as k,aD as O,F as i,aE as T,aF as A,aG as F}from"./index-CZU4bJ5v.js";/* empty css                         *//* empty css                  */import{g as L,q as M}from"./pay-D8J2j7Ih.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"payment-result-container"},J={key:0,class:"result-content success"},$={class:"result-icon"},H={class:"order-info"},K={class:"info-item"},Q={class:"value"},U={key:0,class:"info-item"},W={class:"value price"},X={key:1,class:"info-item"},Y={class:"value"},Z={class:"action-buttons"},h={key:1,class:"result-content failed"},ss={class:"result-icon"},ts={class:"order-info"},es={class:"info-item"},os={class:"value"},as={class:"info-item"},ls={class:"value"},ns={class:"action-buttons"},is={key:2,class:"result-content timeout"},us={class:"result-icon"},ds={class:"order-info"},rs={class:"info-item"},cs={class:"value"},vs={class:"action-buttons"},ps={key:3,class:"result-content cancelled"},fs={class:"result-icon"},ms={class:"order-info"},_s={class:"info-item"},ys={class:"value"},ks={class:"action-buttons"},gs={key:4,class:"result-content loading"},bs={__name:"PaymentResultView",setup(Cs){const p=B(),g=V(),l=y(""),u=y(""),v=y(null),b=y(""),f=()=>{p.push(`/order-detail/${u.value}`)},m=()=>{p.push("/shop")},C=()=>{var s;const o={orderNo:u.value,amount:((s=v.value)==null?void 0:s.totalAmount)||0,businessType:"MALL"};localStorage.setItem("payment_info",JSON.stringify(o)),p.push("/payment")},N=o=>o?new Date(o).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"",D=async()=>{try{const o=await L(u.value);o.data.code===0&&(v.value=o.data.data)}catch(o){console.error("获取订单详情失败:",o)}},E=async()=>{try{const o=await M(u.value);o.data.code===0?o.data.data.status===1?l.value="success":l.value=g.query.status||"failed":(l.value="failed",b.value=o.message)}catch(o){console.error("检查支付状态失败:",o),l.value="failed",b.value="网络异常，请稍后重试"}};return x(async()=>{if(u.value=g.query.orderNo,l.value=g.query.status||"",!u.value){z.error("订单号不存在"),p.push("/orders");return}await D(),(!l.value||l.value==="unknown")&&await E(),localStorage.removeItem("payment_info")}),(o,s)=>{var w;const _=I,n=P,q=R;return r(),d("div",G,[l.value==="success"?(r(),d("div",J,[t("div",$,[e(_,{class:"success-icon",size:"80"},{default:a(()=>[e(k(O))]),_:1})]),s[5]||(s[5]=t("h2",{class:"result-title"},"支付成功",-1)),s[6]||(s[6]=t("p",{class:"result-message"},"恭喜您，订单支付成功！",-1)),t("div",H,[t("div",K,[s[0]||(s[0]=t("span",{class:"label"},"订单号：",-1)),t("span",Q,c(u.value),1)]),v.value?(r(),d("div",U,[s[1]||(s[1]=t("span",{class:"label"},"支付金额：",-1)),t("span",W,"¥"+c((w=v.value.totalAmount)==null?void 0:w.toFixed(2)),1)])):S("",!0),v.value?(r(),d("div",X,[s[2]||(s[2]=t("span",{class:"label"},"支付时间：",-1)),t("span",Y,c(N(v.value.payTime)),1)])):S("",!0)]),t("div",Z,[e(n,{type:"primary",onClick:f},{default:a(()=>s[3]||(s[3]=[i("查看订单详情")])),_:1}),e(n,{onClick:m},{default:a(()=>s[4]||(s[4]=[i("继续购物")])),_:1})])])):l.value==="failed"?(r(),d("div",h,[t("div",ss,[e(_,{class:"failed-icon",size:"80"},{default:a(()=>[e(k(T))]),_:1})]),s[12]||(s[12]=t("h2",{class:"result-title"},"支付失败",-1)),s[13]||(s[13]=t("p",{class:"result-message"},"很抱歉，您的订单支付失败，请重试",-1)),t("div",ts,[t("div",es,[s[7]||(s[7]=t("span",{class:"label"},"订单号：",-1)),t("span",os,c(u.value),1)]),t("div",as,[s[8]||(s[8]=t("span",{class:"label"},"失败原因：",-1)),t("span",ls,c(b.value||"支付过程中出现异常"),1)])]),t("div",ns,[e(n,{type:"primary",onClick:C},{default:a(()=>s[9]||(s[9]=[i("重新支付")])),_:1}),e(n,{onClick:f},{default:a(()=>s[10]||(s[10]=[i("查看订单详情")])),_:1}),e(n,{onClick:m},{default:a(()=>s[11]||(s[11]=[i("继续购物")])),_:1})])])):l.value==="timeout"?(r(),d("div",is,[t("div",us,[e(_,{class:"timeout-icon",size:"80"},{default:a(()=>[e(k(A))]),_:1})]),s[19]||(s[19]=t("h2",{class:"result-title"},"支付超时",-1)),s[20]||(s[20]=t("p",{class:"result-message"},"支付时间已超时，请重新发起支付",-1)),t("div",ds,[t("div",rs,[s[14]||(s[14]=t("span",{class:"label"},"订单号：",-1)),t("span",cs,c(u.value),1)]),s[15]||(s[15]=t("div",{class:"info-item"},[t("span",{class:"label"},"超时时间："),t("span",{class:"value"},"10分钟")],-1))]),t("div",vs,[e(n,{type:"primary",onClick:C},{default:a(()=>s[16]||(s[16]=[i("重新支付")])),_:1}),e(n,{onClick:f},{default:a(()=>s[17]||(s[17]=[i("查看订单详情")])),_:1}),e(n,{onClick:m},{default:a(()=>s[18]||(s[18]=[i("继续购物")])),_:1})])])):l.value==="cancelled"?(r(),d("div",ps,[t("div",fs,[e(_,{class:"cancelled-icon",size:"80"},{default:a(()=>[e(k(F))]),_:1})]),s[25]||(s[25]=t("h2",{class:"result-title"},"支付已取消",-1)),s[26]||(s[26]=t("p",{class:"result-message"},"您已取消本次支付，可以重新发起支付",-1)),t("div",ms,[t("div",_s,[s[21]||(s[21]=t("span",{class:"label"},"订单号：",-1)),t("span",ys,c(u.value),1)])]),t("div",ks,[e(n,{type:"primary",onClick:C},{default:a(()=>s[22]||(s[22]=[i("重新支付")])),_:1}),e(n,{onClick:f},{default:a(()=>s[23]||(s[23]=[i("查看订单详情")])),_:1}),e(n,{onClick:m},{default:a(()=>s[24]||(s[24]=[i("继续购物")])),_:1})])])):(r(),d("div",gs,[e(q,{rows:5,animated:""})]))])}}},qs=j(bs,[["__scopeId","data-v-ae46554b"]]);export{qs as default};
